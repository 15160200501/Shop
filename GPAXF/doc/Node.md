# AXF

## User
- 用户表设计
    - username
    - password
    - email
    - phone
    - icon
    - is_active
    - is_delete
    
## 高级密码安全工具
-  不再使用单一的算法实现了
    - 至少使用两种以上算法
    - 算法中融入时间数列
-  将输入数据进行哈希处理
- 哈希处理之后凭借时间戳
    - 中间使用特定凭借符号
- 验证策略
    - 将输入进行相同的哈希策略
    - 将数据库中的密码进行解码处理
    - 去除时间数列的混淆
    - 比较哈希码

## 版本升级之后，策略不兼容
- 第一版本，注册之后，密码是明文
- 第二版本。注册之后，密码是Hash值
- 第三版本，注册时候，密码是Hash+时间数列
- 假定目前处于第三版本，让你同时第一第二版本
    - 对请求的参数添加版本号，没添加的就是旧版本
    - 对于低版本使用特定认证，认证完，在会话中将低版本的版本号存储下来，
        - 小米低版本兼容
        - 除了密码外，又添加了短信验证码验证

## 用户注册账号时的密码
- 对内使用hashlib算法，在数据库中看不到明文的密码
- 浏览器注册，登录时抓包的时候，密码显示md5加密后的显示

## 用户激活，认证
- 途径
    - 邮件
    - 短信
    - 人工审核
- 邮件
    - 发送邮件
        - 收件人地址
        - 发件人的信息
            - 用户名
            - 密码
            - 服务器
                - 邮件服务器
                - 端口
            - 内容
    - 点击邮件中的链接就可以激活
        - 链接中存在用户的唯一标识
            - http://xxxx/activate/?u_token=YYYY
            - u_token 缓存中 作为key， value->user_id
            - 
        - 标识存在过期时间
        - 标识存在使用次数限制

## redis运行
    - 指令为redis-server.exe redis.windows.conf

### homework
- 邮箱校验
- 密码一致性校验
- 自己封装一个高级密码安全工具

## 错误信息
- 先将错误信息存储下来
- 在错误显示页面获取错误信息
    - 保证错误信息只能出现一次
    - 获取到数据之后，直接将自己删除
    
## 购物车
- 购物多对多的关系
    - 用户
    - 商品
- 订单
    -  订单和已购买商品是一对多的关系
    -   表关系
        - 订单表
            - 属于哪个用户
        - 订单商品表
            - 购物车里
        - 地址
           - 每个订单对应一个地址
           - 一个地址可以对应多个订单
           - 订单会级联收货地址表 
        -  优惠券
        
-   添加购物车
    - 需要用户
        - 如果用户未登录，直接跳转登录
    - 需要商品
        - 传递商品唯一标识
    - 添加的合法性
        - 此数据不存在，创建购物车数据
        - 如果此数据存在，直接将数量加一
        
## 小技能
-   js获取jquery对象属性
    - attr
        - 可以获取任意属性
    - prop
        - 只能获取内部属性
        
## 浏览器行为
-   重定向
- 跨域
        
## 项目中多块罗i拥有相同操作
- 封装成一个函数
- 装饰器
- 中间件

## 购物车加减号步骤
- 先在cart.html加减号的地方，插入一个class="subShopping"的选择器
- 然后在cart.js中添加点击事件，通过商品id进行增删
- 然后在urls.py中添加路径
- 然后在views.py中写视图函数
- 写好函数里的内容，点击减号可以在浏览器的console中看到运行日志减一
- 然后在js里面写判断，加一减一通过状态进行判断，减到最后直接删除

###
- 默认状态
    - 全选按钮是选中
        -内部所有商品都是选中的
    - 全部按钮未选中
        - 内部商品中只要存在未选中的，全选就应该是未选中
- 点击全选
    - 原状态是选中
        - 全选和所有商品都变成选中
    - 原状态是未选中
        - 全选和所有商品都变成选中
- 点击单个商品
    - 商品由选中变成未选中
        - 全选一定百年城未选中
    - 商品由未选中选中
        - 那全选的默认状态就是未选中
        - 可能变成选中
        
## 支付按钮
- 在order_detail.html中添加支付按钮的id属性为alipay
- 在头部添加js的点击事件
    - {% block ext_js %}
    - {{ block.super }}
    - script type="text/javascript" href="{% static '' %}"></script>
    - {% endblock %}
- 创建js文件
    - function导入
    - 添加alipay的点击事件
    
## mine页面中待付款的流程
- 在mine.html待付款那边添加一个id，在对应的mine.js中添加windows.open
- 之后在urls.py添加路径,再在views.py中写，因为需要登录
- 在中间件添加路由
- views中返回渲染的画面，需要添加html文件 
- 在views返回的html路径页面，在html添加ext_css\ext_js\content
- 在content中添加显示的内容，运行看一下状态
- 样式有点丑，在ul标签中添加每个订单的class
- 创建一个js文件，在html中的ext_js中添加该路径,对orderid添加点击
- 在js中写,先找到这个class，找到其属性，点击，进入订单详情页面
- 

### 支付
- 官方文档
- 常见的支付
    - 支付宝
        - 企业资质
        - 营业执照
    - 微信
        - 要求同支付宝
        - 要认证，一次200，一年收一次
    - 银联
    - 百度钱包
    - 京东钱包
    
- 支付宝支付
    - 支付宝开放平台
    - 蚂蚁金服开发平台